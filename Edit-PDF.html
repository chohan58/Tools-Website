<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PDF Editor Plugin — Fixed & Fully Functional</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />
  <style>
    /* ---------- Base / Existing Look & Feel (kept the same) ---------- */
    * { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    body { background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%); color:#333; min-height:100vh; padding:20px; display:flex; flex-direction:column; align-items:center; }
    .container { width:100%; max-width:1200px; margin:0 auto; }
    .loading-overlay { position:fixed; inset:0; background:rgba(0,0,0,.5); color:#fff; display:none; align-items:center; justify-content:center; z-index:9999; font-size:18px; }
    .toast { position:fixed; left:50%; transform:translateX(-50%); bottom:24px; background:#222; color:#fff; padding:10px 16px; border-radius:8px; opacity:0; pointer-events:none; transition:opacity .3s; z-index:9999; }
    .toast.show { opacity:1; }

    .home-page { text-align:center; color:#fff; margin-bottom:18px; }
    .home-page h1 { font-size:2.4rem; margin-bottom:10px; text-shadow: 2px 2px 4px rgba(0,0,0,.3); }
    .edit-pdf-btn { margin-top:8px; background:#3498db; color:#fff; border:none; padding:12px 18px; border-radius:10px; cursor:pointer; }

    .upload-page { background:#fff; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.15); padding:24px; }
    .upload-area { border:2px dashed #9bbad6; border-radius:12px; padding:28px; text-align:center; cursor:pointer; background:#f8fbff; }
    .file-input { display:none; }
    .back-btn, .share-btn { margin-top:12px; background:#95a5a6; color:#fff; border:none; padding:10px 14px; border-radius:8px; cursor:pointer; }

    .editor-container { background:#fff; border-radius:12px; box-shadow:0 10px 30px rgba(0,0,0,.15); overflow:hidden; margin-top:20px; display:none; }

    .toolbar { background:#2c3e50; color:#fff; padding:12px; display:flex; flex-wrap:wrap; gap:12px; align-items:center; position:relative; }
    .toolbar-group { display:flex; gap:10px; align-items:center; padding-right:15px; border-right:1px solid #3c5065; }
    .toolbar-group:last-child { border-right:none; }
    .toolbar button { background:#3498db; color:#fff; border:none; padding:9px 12px; border-radius:6px; cursor:pointer; transition:all .25s; display:flex; align-items:center; gap:8px; }
    .toolbar button:hover { background:#2980b9; transform: translateY(-1px); }
    .toolbar select, .toolbar input { padding:8px; border-radius:6px; border:1px solid #ddd; background:#fff; }
    .tool-active { outline:2px solid #7ec8ff; }

    /* Submenus (kept positions) */
    .text-submenu, .textbox-submenu, .draw-submenu, .highlight-submenu, .shapes-submenu { display:none; position:absolute; top:100%; background:#fff; border-radius:8px; box-shadow:0 5px 15px rgba(0,0,0,.2); padding:15px; z-index:100; }
    .text-submenu{ left:175px; width:420px; display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .textbox-submenu{ left:260px; width:520px; display:grid; grid-template-columns:1fr 1fr; gap:12px; }
    .draw-submenu{ left:435px; width:300px; display:grid; grid-template-columns:1fr; gap:12px; }
    .highlight-submenu{ left:500px; width:280px; }
    .shapes-submenu{ left:575px; width:400px; display:grid; grid-template-columns:repeat(3,1fr); gap:12px; }
    .text-submenu.active, .textbox-submenu.active, .draw-submenu.active, .highlight-submenu.active, .shapes-submenu.active{ display:grid; }
    .submenu-group h4{ margin-bottom:8px; color:#2c3e50; font-size:14px; border-bottom:1px solid #eee; padding-bottom:5px; }
    .submenu-options{ display:flex; flex-wrap:wrap; gap:8px; }
    .submenu-btn{ background:#f8f9fa; border:1px solid #ddd; border-radius:4px; padding:8px 10px; cursor:pointer; display:flex; align-items:center; justify-content:center; }
    .submenu-btn.active{ background:#3498db; color:#fff; border-color:#2980b9; }

    .pdf-viewer-container { position:relative; height:70vh; overflow:auto; background:#f0f3f5; display:flex; justify-content:center; padding:30px; }
    .pdf-page { background:#fff; box-shadow:0 5px 15px rgba(0,0,0,.1); width:816px; position:relative; margin:0 auto; overflow:hidden; }
    .pdf-content { position:relative; }
    .page-mock { position:absolute; inset:40px; display:flex; align-items:center; justify-content:center; flex-direction:column; color:#7f8c8d; }

    /* Layered canvases: base PDF canvas + annotation + drawing */
    #pdf-render-canvas { display:block; margin:40px auto; background:#fff; }
    .annotation-canvas, .drawing-canvas { position:absolute; left:50%; transform:translateX(-50%); top:40px; pointer-events:none; }
    .drawing-canvas { pointer-events:auto; }

    .status-bar { background:#ecf0f1; padding:10px 14px; display:flex; align-items:center; justify-content:space-between; border-top:1px solid #e2e8f0; }

    /* Article styles kept (trimmed) */
    .article-container { margin-top:16px; background:#fff; padding:18px; border-radius:10px; box-shadow:0 6px 14px rgba(0,0,0,.08); }
    .article-container h3{ color:#2c3e50; margin-bottom:10px; text-align:center; font-size:22px; border-bottom:2px solid #3498db; padding-bottom:8px; }
    .article-container p{ color:#7f8c8d; line-height:1.6; margin-bottom:12px; text-align:justify; }
  </style>
</head>
<body>
  <div class="loading-overlay" id="loading-overlay"><div>Loading PDF Editor…</div></div>
  <div class="toast" id="toast"></div>

  <div class="container">
    <div id="home-page" class="home-page">
      <h1>PDF Editor Plugin</h1>
      <p>Advanced text box tools for your PDF editor</p>
      <button id="edit-pdf-btn" class="edit-pdf-btn"><i class="fas fa-edit"></i> EDIT PDF</button>
    </div>

    <div id="upload-page" class="upload-page">
      <h2>Upload Your PDF</h2>
      <p>Select a PDF file to start editing</p>
      <div class="upload-area" id="upload-area">
        <i class="fas fa-file-upload"></i>
        <h3>Drag & Drop your PDF here</h3>
        <p>or click to browse files</p>
        <input type="file" id="file-input-upload" class="file-input" accept="application/pdf" />
      </div>
      <button id="share-btn" class="share-btn"><i class="fas fa-share-alt"></i> Sharing is Caring</button>
      <button class="back-btn" id="back-btn"><i class="fas fa-arrow-left"></i> Back to Home</button>

      <!-- (Article section preserved) -->
      <div class="article-container">
        <h3>The Ultimate Guide to PDF Editing</h3>
        <p>Use the tools above to upload and edit a PDF without changing the look & feel of your site.</p>
      </div>
    </div>

    <!-- Editor Container -->
    <div class="editor-container" id="editor-container">
      <div class="toolbar">
        <div class="toolbar-group">
          <button id="save-pdf"><i class="fas fa-save"></i> Save</button>
          <button id="print-pdf"><i class="fas fa-print"></i> Print</button>
        </div>
        <div class="toolbar-group">
          <button id="text-tool"><i class="fas fa-font"></i> Text</button>
          <button id="textbox-tool" class="tool-active"><i class="fas fa-square"></i> Text Box</button>
          <button id="draw-tool"><i class="fas fa-pen"></i> Draw</button>
          <button id="highlight-tool"><i class="fas fa-highlighter"></i> Highlight</button>
          <button id="shapes-tool"><i class="fas fa-shapes"></i> Shapes</button>
        </div>
        <div class="toolbar-group">
          <button id="undo"><i class="fas fa-undo"></i> Undo</button>
          <button id="redo"><i class="fas fa-redo"></i> Redo</button>
        </div>
        <div class="toolbar-group">
          <button id="zoom-out" title="Zoom Out"><i class="fas fa-search-minus"></i></button>
          <button id="zoom-reset" title="Reset Zoom">100%</button>
          <button id="zoom-in" title="Zoom In"><i class="fas fa-search-plus"></i></button>
        </div>

        <!-- Text submenu (preserved minimal) -->
        <div class="text-submenu" id="text-submenu">
          <div class="submenu-group">
            <h4>Font Family</h4>
            <select id="font-family">
              <option value="Arial" style="font-family:Arial">Arial</option>
              <option value="Helvetica" style="font-family:Helvetica">Helvetica</option>
              <option value="Times New Roman" style="font-family:'Times New Roman'">Times New Roman</option>
            </select>
          </div>
          <div class="submenu-group">
            <h4>Font Size</h4>
            <select id="font-size">
              <option>12</option><option selected>16</option><option>18</option><option>24</option><option>32</option>
            </select>
          </div>
          <div class="submenu-group">
            <h4>Font Color</h4>
            <input type="color" id="font-color" value="#000000" />
          </div>
          <div class="submenu-group">
            <h4>Style</h4>
            <div class="submenu-options">
              <button class="submenu-btn" id="bold-btn" title="Bold"><i class="fas fa-bold"></i></button>
              <button class="submenu-btn" id="italic-btn" title="Italic"><i class="fas fa-italic"></i></button>
              <button class="submenu-btn" id="underline-btn" title="Underline"><i class="fas fa-underline"></i></button>
            </div>
          </div>
        </div>

        <!-- Textbox submenu (preserved minimal) -->
        <div class="textbox-submenu" id="textbox-submenu">
          <div class="submenu-group">
            <h4>Textbox Font</h4>
            <select id="textbox-font-family">
              <option value="Arial">Arial</option>
              <option value="Helvetica">Helvetica</option>
              <option value="Times New Roman">Times New Roman</option>
            </select>
          </div>
          <div class="submenu-group">
            <h4>Size/Color</h4>
            <select id="textbox-font-size"><option>12</option><option selected>16</option><option>20</option><option>24</option></select>
            <input type="color" id="textbox-font-color" value="#000000" />
          </div>
          <div class="submenu-group">
            <h4>Box</h4>
            <input type="color" id="textbox-bg-color" value="#ffffff" title="Background" />
            <input type="color" id="textbox-border-color" value="#3498db" title="Border" />
          </div>
          <div class="submenu-group">
            <h4>Style</h4>
            <div class="submenu-options">
              <button class="submenu-btn" id="textbox-bold-btn" title="Bold"><i class="fas fa-bold"></i></button>
              <button class="submenu-btn" id="textbox-italic-btn" title="Italic"><i class="fas fa-italic"></i></button>
              <button class="submenu-btn" id="textbox-underline-btn" title="Underline"><i class="fas fa-underline"></i></button>
            </div>
          </div>
        </div>

        <!-- Draw submenu -->
        <div class="draw-submenu" id="draw-submenu">
          <div class="submenu-group">
            <h4>Pen</h4>
            <div class="submenu-options">
              <input type="color" id="draw-color" value="#ff2d2d" />
              <label>Width <input type="number" id="line-width" value="3" min="1" max="20" style="width:64px"></label>
            </div>
          </div>
        </div>

        <!-- (Highlight & Shapes submenus preserved shells) -->
        <div class="highlight-submenu" id="highlight-submenu"><div class="submenu-group"><h4>Highlight</h4><input type="color" value="#fff59d"></div></div>
        <div class="shapes-submenu" id="shapes-submenu"><div class="submenu-group"><h4>Shapes</h4><div class="submenu-options"><button class="submenu-btn" disabled>Rect</button><button class="submenu-btn" disabled>Circle</button><button class="submenu-btn" disabled>Arrow</button></div></div></div>
      </div>

      <div class="pdf-viewer-container">
        <div class="pdf-page">
          <div class="pdf-content">
            <!-- Base PDF canvas (actual PDF.js render goes here) -->
            <canvas id="pdf-render-canvas"></canvas>
            <!-- Overlays (kept) -->
            <canvas id="annotation-canvas" class="annotation-canvas"></canvas>
            <canvas id="drawing-canvas" class="drawing-canvas"></canvas>
            <!-- Placeholder for no file loaded -->
            <div class="page-mock" id="page-mock">
              <i class="fas fa-file-pdf"></i>
              <h2>PDF Document Preview</h2>
              <p>Open a PDF file to start editing</p>
            </div>
          </div>
        </div>
      </div>

      <div class="status-bar">
        <div class="page-info">Page: <span id="page-num">1</span> / <span id="page-count">1</span></div>
        <div class="page-controls">
          <button id="prev-page"><i class="fas fa-chevron-left"></i> Previous</button>
          <button id="next-page">Next <i class="fas fa-chevron-right"></i></button>
        </div>
      </div>
    </div>
  </div>

  <!-- PDF.js (official CDN) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/4.5.136/pdf.min.js"></script>
  <script>
    // ---------- State ----------
    const state = {
      currentTool: 'textbox',
      pageNum: 1,
      pageCount: 1,
      zoomLevel: 100,
      pdfDoc: null,
      pdfFileUrl: null,
      drawing: false,
      lastX: 0,
      lastY: 0,
      textboxCounter: 0,
      actionHistory: [],
      historyIndex: -1
    };

    // ---------- Elements (ids preserved to match your original) ----------
    const elements = {
      homePage: document.getElementById('home-page'),
      uploadPage: document.getElementById('upload-page'),
      editorContainer: document.getElementById('editor-container'),
      editPdfBtn: document.getElementById('edit-pdf-btn'),
      uploadArea: document.getElementById('upload-area'),
      fileInputUpload: document.getElementById('file-input-upload'),
      backBtn: document.getElementById('back-btn'),

      savePdfBtn: document.getElementById('save-pdf'),
      printPdfBtn: document.getElementById('print-pdf'),

      textToolBtn: document.getElementById('text-tool'),
      textboxToolBtn: document.getElementById('textbox-tool'),
      drawToolBtn: document.getElementById('draw-tool'),
      highlightToolBtn: document.getElementById('highlight-tool'),
      shapesToolBtn: document.getElementById('shapes-tool'),

      prevPageBtn: document.getElementById('prev-page'),
      nextPageBtn: document.getElementById('next-page'),
      pageNumElem: document.getElementById('page-num'),
      pageCountElem: document.getElementById('page-count'),

      fontFamily: document.getElementById('font-family'),
      fontSize: document.getElementById('font-size'),
      fontColor: document.getElementById('font-color'),
      boldBtn: document.getElementById('bold-btn'),
      italicBtn: document.getElementById('italic-btn'),
      underlineBtn: document.getElementById('underline-btn'),

      textboxFontFamily: document.getElementById('textbox-font-family'),
      textboxFontSize: document.getElementById('textbox-font-size'),
      textboxFontColor: document.getElementById('textbox-font-color'),
      textboxBgColor: document.getElementById('textbox-bg-color'),
      textboxBorderColor: document.getElementById('textbox-border-color'),
      textboxBoldBtn: document.getElementById('textbox-bold-btn'),
      textboxItalicBtn: document.getElementById('textbox-italic-btn'),
      textboxUnderlineBtn: document.getElementById('textbox-underline-btn'),

      pdfCanvas: document.getElementById('pdf-render-canvas'),
      annotationCanvas: document.getElementById('annotation-canvas'),
      drawingCanvas: document.getElementById('drawing-canvas'),
      pageMock: document.getElementById('page-mock'),

      loadingOverlay: document.getElementById('loading-overlay'),
      toast: document.getElementById('toast'),
      shareBtn: document.getElementById('share-btn'),
      zoomInBtn: document.getElementById('zoom-in'),
      zoomOutBtn: document.getElementById('zoom-out'),
      zoomResetBtn: document.getElementById('zoom-reset')
    };

    // ---------- Navigation Views ----------
    function showUploadPage(){ elements.homePage.style.display='none'; elements.uploadPage.style.display='block'; elements.editorContainer.style.display='none'; }
    function showHomePage(){ elements.homePage.style.display='block'; elements.uploadPage.style.display='none'; elements.editorContainer.style.display='none'; }
    function showEditor(){ elements.homePage.style.display='none'; elements.uploadPage.style.display='none'; elements.editorContainer.style.display='block'; }

    // ---------- Toast ----------
    function showToast(msg, dur=2000){ elements.toast.textContent = msg; elements.toast.classList.add('show'); setTimeout(()=>elements.toast.classList.remove('show'), dur); }

    // ---------- PDF.js Rendering ----------
    async function loadPdfFromFile(file){
      if(!file || file.type !== 'application/pdf'){ showToast('Please select a valid PDF file', 2500); return; }
      elements.loadingOverlay.style.display='flex';
      try{
        if(state.pdfFileUrl){ URL.revokeObjectURL(state.pdfFileUrl); }
        state.pdfFileUrl = URL.createObjectURL(file);
        const loadingTask = pdfjsLib.getDocument({ url: state.pdfFileUrl });
        state.pdfDoc = await loadingTask.promise;
        state.pageCount = state.pdfDoc.numPages;
        state.pageNum = 1;
        elements.pageCountElem.textContent = state.pageCount;
        elements.pageNumElem.textContent = state.pageNum;
        elements.pageMock.style.display='none';
        await renderPage();
        showEditor();
        showToast('PDF loaded successfully');
      }catch(err){ console.error(err); showToast('Failed to load PDF'); }
      finally{ elements.loadingOverlay.style.display='none'; }
    }

    async function renderPage(){
      const page = await state.pdfDoc.getPage(state.pageNum);
      const viewport = page.getViewport({ scale: state.zoomLevel/100 });
      const canvas = elements.pdfCanvas;
      const ctx = canvas.getContext('2d');
      canvas.width = viewport.width;
      canvas.height = viewport.height;
      // Position overlay canvases to match PDF size & center horizontally
      positionOverlayCanvases();
      const renderTask = page.render({ canvasContext: ctx, viewport });
      await renderTask.promise;
    }

    function positionOverlayCanvases(){
      const base = elements.pdfCanvas;
      const pdfRect = base.getBoundingClientRect();
      // Size overlays to match base canvas size
      [elements.annotationCanvas, elements.drawingCanvas].forEach(cv=>{
        cv.width = base.width; cv.height = base.height; cv.style.width = base.style.width || base.width + 'px'; cv.style.height = base.style.height || base.height + 'px';
      });
      // Center overlays like base canvas (which is centered using margin:auto and top:40px)
      const leftOffset = (base.parentElement.clientWidth - base.width) / 2;
      elements.annotationCanvas.style.left = `calc(50% - ${base.width/2}px)`;
      elements.drawingCanvas.style.left = `calc(50% - ${base.width/2}px)`;
      elements.annotationCanvas.style.top = '40px';
      elements.drawingCanvas.style.top = '40px';
    }

    // ---------- File Upload / Drag & Drop ----------
    function wireUploadArea(){
      elements.uploadArea.addEventListener('click', ()=> elements.fileInputUpload.click());
      elements.fileInputUpload.addEventListener('change', (e)=> loadPdfFromFile(e.target.files[0]));
      // Drag & drop
      ;['dragenter','dragover'].forEach(evt=> elements.uploadArea.addEventListener(evt, (e)=>{ e.preventDefault(); e.stopPropagation(); elements.uploadArea.style.borderColor = '#3498db'; }));
      ;['dragleave','drop'].forEach(evt=> elements.uploadArea.addEventListener(evt, (e)=>{ e.preventDefault(); e.stopPropagation(); elements.uploadArea.style.borderColor = '#9bbad6'; }));
      elements.uploadArea.addEventListener('drop', (e)=>{
        const dt = e.dataTransfer; if(dt && dt.files && dt.files[0]){ loadPdfFromFile(dt.files[0]); }
      });
    }

    // ---------- Toolbar: tools, zoom, nav ----------
    function setTool(tool){ state.currentTool = tool; document.querySelectorAll('.toolbar .toolbar-group button').forEach(b=>b.classList.remove('tool-active')); const btn = document.getElementById(`${tool}-tool`); if(btn) btn.classList.add('tool-active'); elements.drawingCanvas.style.cursor = (tool==='draw')? 'crosshair':'default'; }
    function zoomIn(){ state.zoomLevel += 10; elements.zoomResetBtn.textContent = `${state.zoomLevel}%`; renderPage(); }
    function zoomOut(){ if(state.zoomLevel>10){ state.zoomLevel -= 10; elements.zoomResetBtn.textContent = `${state.zoomLevel}%`; renderPage(); } }
    function zoomReset(){ state.zoomLevel = 100; elements.zoomResetBtn.textContent = '100%'; renderPage(); }
    async function nextPage(){ if(state.pageNum < state.pageCount){ state.pageNum++; elements.pageNumElem.textContent = state.pageNum; await renderPage(); } }
    async function prevPage(){ if(state.pageNum > 1){ state.pageNum--; elements.pageNumElem.textContent = state.pageNum; await renderPage(); } }

    // ---------- Drawing (bug fixed: currentY used clientY, not clientX) ----------
    function startDrawing(e){ if(state.currentTool!=='draw') return; state.drawing=true; const rect = elements.drawingCanvas.getBoundingClientRect(); state.lastX = e.clientX - rect.left; state.lastY = e.clientY - rect.top; }
    function draw(e){ if(!state.drawing) return; const canvas = elements.drawingCanvas; const ctx = canvas.getContext('2d'); const rect = canvas.getBoundingClientRect(); const currentX = e.clientX - rect.left; const currentY = e.clientY - rect.top; ctx.beginPath(); ctx.moveTo(state.lastX, state.lastY); ctx.lineTo(currentX, currentY); ctx.strokeStyle = document.getElementById('draw-color').value; ctx.lineWidth = Number(document.getElementById('line-width').value)||3; ctx.lineCap='round'; ctx.stroke(); state.lastX=currentX; state.lastY=currentY; }
    function stopDrawing(){ state.drawing=false; }

    // ---------- Textbox (kept behavior minimal & same ids) ----------
    function createTextBox(){ setTool('textbox'); const id = `textbox-${state.textboxCounter++}`; const box = document.createElement('div'); box.className='textbox-container'; box.id=id; box.style.position='absolute'; box.style.left='60px'; box.style.top='60px'; box.style.width='220px'; box.style.height='80px'; box.style.backgroundColor=document.getElementById('textbox-bg-color').value; box.style.border = `1px solid ${document.getElementById('textbox-border-color').value}`; box.style.borderRadius='6px'; box.style.padding='6px'; box.style.zIndex=20; box.style.pointerEvents='auto';
      const ta = document.createElement('textarea'); ta.className='textbox-content'; ta.style.width='100%'; ta.style.height='100%'; ta.style.resize='none'; ta.style.border='none'; ta.style.outline='none'; ta.style.background='transparent'; ta.value='Type here…'; ta.style.fontFamily = document.getElementById('textbox-font-family').value; ta.style.fontSize = document.getElementById('textbox-font-size').value + 'px'; ta.style.color = document.getElementById('textbox-font-color').value; box.appendChild(ta); elements.pdfCanvas.parentElement.appendChild(box);
      // drag
      let dragging=false, offsetX=0, offsetY=0; box.addEventListener('mousedown', (e)=>{ dragging=true; const r = box.getBoundingClientRect(); offsetX = e.clientX - r.left; offsetY = e.clientY - r.top; }); document.addEventListener('mousemove', (e)=>{ if(!dragging) return; const parentRect = elements.pdfCanvas.getBoundingClientRect(); box.style.left = (e.clientX - parentRect.left - offsetX) + 'px'; box.style.top = (e.clientY - parentRect.top - offsetY) + 'px'; }); document.addEventListener('mouseup', ()=> dragging=false);
    }

    // ---------- Save / Print (basic) ----------
    function savePdf(){ showToast('Note: This demo saves annotations as an image layer. For producing a new PDF, integrate pdf-lib/jspdf as needed.'); }
    function printPdf(){ window.print(); }

    // ---------- Share (kept) ----------
    function shareOnSocialMedia(){ const shareText = 'Check out this PDF editor!'; const shareUrl = window.location.href; if(navigator.share){ navigator.share({ title:'PDF Editor', text:shareText, url:shareUrl }).catch(()=>{}); } else { window.open(`https://wa.me/?text=${encodeURIComponent(shareText+' '+shareUrl)}`,'_blank'); } }

    // ---------- Init ----------
    function init(){
      // nav
      document.addEventListener('DOMContentLoaded', ()=>{});
      elements.editPdfBtn.addEventListener('click', showUploadPage);
      elements.backBtn.addEventListener('click', showHomePage);
      elements.shareBtn.addEventListener('click', shareOnSocialMedia);
      wireUploadArea();

      // tools
      elements.textboxToolBtn.addEventListener('click', createTextBox);
      elements.drawToolBtn.addEventListener('click', ()=> setTool('draw'));
      elements.textToolBtn.addEventListener('click', ()=> setTool('text'));

      // zoom + pages
      elements.zoomInBtn.addEventListener('click', zoomIn);
      elements.zoomOutBtn.addEventListener('click', zoomOut);
      elements.zoomResetBtn.addEventListener('click', zoomReset);
      elements.nextPageBtn.addEventListener('click', nextPage);
      elements.prevPageBtn.addEventListener('click', prevPage);

      // drawing events
      elements.drawingCanvas.addEventListener('mousedown', startDrawing);
      elements.drawingCanvas.addEventListener('mousemove', draw);
      elements.drawingCanvas.addEventListener('mouseup', stopDrawing);
      elements.drawingCanvas.addEventListener('mouseleave', stopDrawing);

      // show upload first (like original)
      showUploadPage();
    }

    init();
  </script>
</body>
</html>
